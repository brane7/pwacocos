System.register("chunks:///_virtual/main",["./PWAInstaller.ts"],(function(){return{setters:[null],execute:function(){}}}));

System.register("chunks:///_virtual/PWAInstaller.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,s,n,o,i,l,r,a,u,c,h,d;return{setters:[function(t){e=t.applyDecoratedDescriptor,s=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized,i=t.asyncToGenerator,l=t.regeneratorRuntime},function(t){r=t.cclegacy,a=t._decorator,u=t.Button,c=t.Label,h=t.sys,d=t.Component}],execute:function(){var p,f,g,I,m,b,P,v,L;r._RF.push({},"72048sXgK5KG4XP/f3z1DCG","PWAInstaller",void 0);var A=a.ccclass,y=a.property;t("PWAInstaller",(p=A("PWAInstaller"),f=y(u),g=y(c),I=y(c),p((P=e((b=function(t){function e(){for(var e,s=arguments.length,i=new Array(s),l=0;l<s;l++)i[l]=arguments[l];return e=t.call.apply(t,[this].concat(i))||this,n(e,"installButton",P,o(e)),n(e,"versionLabel",v,o(e)),n(e,"statusLabel",L,o(e)),e.deferredPrompt=null,e.isInstalled=!1,e}s(e,t);var r=e.prototype;return r.start=function(){this.checkPWAInstallation(),this.setupEventListeners(),this.updateUI(),this.versionLabel.string="v3.0.0"},r.checkPWAInstallation=function(){h.isBrowser&&(window.matchMedia("(display-mode: standalone)").matches&&(this.isInstalled=!0),console.log("isInstalled",this.isInstalled),console.log("브라우저 환경:",h.isBrowser),console.log("display-mode standalone:",window.matchMedia("(display-mode: standalone)").matches),this.validatePWARequirements())},r.validatePWARequirements=function(){var t=this;console.log("🔍 PWA 요구사항 검증 시작...");var e=document.querySelector('link[rel="manifest"]');e?(console.log("✅ 매니페스트 링크 발견:",e.href),this.statusLabel.string="PWA 요구사항 검증 중...",fetch(e.href).then((function(t){if(console.log("📋 매니페스트 응답 상태:",t.status),t.ok)return t.json();throw new Error("매니페스트 로드 실패: "+t.status)})).then((function(e){console.log("📋 매니페스트 내용:",e),console.log("🖼️ 아이콘 정보:",e.icons);var s=["name","short_name","start_url","display"].filter((function(t){return!e[t]}));if(s.length>0)return console.log("❌ 누락된 필수 필드:",s),void(t.statusLabel.string="매니페스트 누락: "+s.join(", "));if(e.icons&&e.icons.length>0){var n=e.icons[0].src;console.log("🖼️ 아이콘 경로:",n),fetch(n,{method:"HEAD"}).then((function(e){console.log("🖼️ 아이콘 파일 상태:",e.status),e.ok?(console.log("✅ 아이콘 파일 정상"),t.statusLabel.string="PWA 요구사항 검증 완료",t.checkInstallability()):(console.log("❌ 아이콘 파일 문제:",e.status),t.statusLabel.string="아이콘 파일 오류: "+e.status)})).catch((function(e){console.log("❌ 아이콘 파일 확인 실패:",e),t.statusLabel.string="아이콘 파일 확인 실패"}))}else console.log("❌ 아이콘 정보가 없습니다"),t.statusLabel.string="매니페스트에 아이콘 정보가 없습니다"})).catch((function(e){console.log("❌ 매니페스트 파싱 실패:",e),t.statusLabel.string="매니페스트 파싱 실패"}))):(console.log("❌ 매니페스트 링크를 찾을 수 없습니다"),this.statusLabel.string="매니페스트 파일을 찾을 수 없습니다")},r.checkInstallability=function(){this.deferredPrompt?(console.log("🎯 PWA 설치 준비 완료!"),this.statusLabel.string="설치할 준비가 되었습니다"):(console.log("⏳ PWA 설치 이벤트 대기 중..."),this.statusLabel.string="PWA 설치 이벤트 대기 중...")},r.setupEventListeners=function(){var t=this;this.installButton&&this.installButton.node.on(u.EventType.CLICK,this.onInstallButtonClick,this),h.isBrowser&&(window.addEventListener("beforeinstallprompt",(function(e){e.preventDefault(),t.deferredPrompt=e,t.updateUI()})),window.addEventListener("appinstalled",(function(){t.isInstalled=!0,t.updateUI(),console.log("PWA가 성공적으로 설치되었습니다!")})))},r.onInstallButtonClick=function(){this.deferredPrompt?this.showInstallPrompt():this.isInstalled?this.showAlreadyInstalledMessage():this.showInstallInstructions()},r.showInstallPrompt=function(){var t=i(l().mark((function t(){var e;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.deferredPrompt){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,this.deferredPrompt.prompt(),t.next=6,this.deferredPrompt.userChoice;case 6:e=t.sent,"accepted"===e.outcome?(console.log("사용자가 PWA 설치를 수락했습니다"),this.statusLabel.string="설치 중..."):(console.log("사용자가 PWA 설치를 거부했습니다"),this.statusLabel.string="설치가 취소되었습니다"),this.deferredPrompt=null,this.updateUI(),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(2),console.error("PWA 설치 중 오류 발생:",t.t0),this.statusLabel.string="설치 중 오류가 발생했습니다";case 17:case"end":return t.stop()}}),t,this,[[2,13]])})));return function(){return t.apply(this,arguments)}}(),r.showAlreadyInstalledMessage=function(){var t=this;this.statusLabel.string="PWA가 이미 설치되어 있습니다!",setTimeout((function(){t.updateUI()}),2e3)},r.showInstallInstructions=function(){var t=this;this.statusLabel.string="브라우저에서 설치 옵션을 찾아주세요",setTimeout((function(){t.updateUI()}),3e3)},r.updateUI=function(){this.installButton&&this.statusLabel&&(console.log("isInstalled",this.isInstalled),console.log("deferredPrompt",this.deferredPrompt),this.isInstalled?(this.installButton.node.getComponentInChildren(c).string="이미 설치됨",this.statusLabel.string="PWA가 설치되어 있습니다"):this.deferredPrompt?(this.installButton.node.getComponentInChildren(c).string="PWA 설치",this.statusLabel.string="설치할 준비가 되었습니다"):(this.installButton.node.getComponentInChildren(c).string="설치 불가",this.statusLabel.string="이 브라우저에서는 PWA 설치가 지원되지 않습니다"))},r.isPWAInstallable=function(){return null!==this.deferredPrompt&&!this.isInstalled},r.refreshInstallationStatus=function(){this.checkPWAInstallation(),this.updateUI()},r.onDestroy=function(){this.installButton&&this.installButton.node.off(u.EventType.CLICK,this.onInstallButtonClick,this)},e}(d)).prototype,"installButton",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=e(b.prototype,"versionLabel",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=e(b.prototype,"statusLabel",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=b))||m));r._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});